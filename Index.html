<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;500;600&display=swap" rel="stylesheet">
  <style>
    body { background: linear-gradient(135deg, #00d2ff 0%, #928dab 100%); font-family: 'Prompt', sans-serif; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; padding: 20px; box-sizing: border-box; }
    .container { background: rgba(255, 255, 255, 0.92); backdrop-filter: blur(10px); padding: 35px; border-radius: 35px; width: 100%; max-width: 420px; text-align: center; box-shadow: 0 20px 45px rgba(0,0,0,0.15); position: relative; }
    .lang-switch { text-align: right; margin-bottom: 15px; }
    .lang-btn { background: #f0f0f0; border: 1px solid #ddd; color: #666; padding: 4px 12px; border-radius: 12px; cursor: pointer; font-size: 12px; transition: 0.3s; }
    .lang-btn.active { background: #4e4376; color: white; border-color: #4e4376; box-shadow: 0 4px 10px rgba(78,67,118,0.3); }
 
    h2 { color: #2b5876; margin-bottom: 8px; font-size: 24px; font-weight: 600; line-height: 1.3; }
    #ui-subtext { font-size: 14px; color: #555; margin-bottom: 25px; line-height: 1.5; padding: 0 10px; } 
    textarea { width: 100%; height: 130px; border: 2px solid #e0e0e0; border-radius: 22px; padding: 18px; font-size: 16px; outline: none; resize: none; box-sizing: border-box; transition: 0.3s; background: white; font-family: 'Prompt', sans-serif; }
    textarea:focus { border-color: #00d2ff; box-shadow: 0 0 15px rgba(0,210,255,0.2); } 
    .btn-group { margin-top: 20px; display: flex; gap: 15px; justify-content: center; }
    .icon-btn { background: white; color: #00838f; border: 1px solid #e0f7fa; width: 55px; height: 55px; border-radius: 50%; cursor: pointer; transition: 0.3s; font-size: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
    .icon-btn:hover { transform: translateY(-3px); color: #00d2ff; }    

    #sendBtn { background: linear-gradient(to right, #4e4376, #2b5876); color: white; border: none; padding: 16px; border-radius: 50px; font-weight: 600; font-size: 16px; margin-top: 25px; width: 100%; cursor: pointer; box-shadow: 0 10px 20px rgba(78,67,118,0.3); transition: 0.3s; }
    #sendBtn:hover { transform: translateY(-2px); filter: brightness(1.1); }
    #saveBtn { display: none; background: #00c853; color: white; border: none; padding: 14px; border-radius: 50px; width: 100%; margin-top: 15px; cursor: pointer; font-weight: 600; }
    #preview { width: 100%; border-radius: 20px; margin-top: 20px; display: none; max-height: 220px; object-fit: cover; }
    #result { 
      margin-top: 30px; 
      padding: 25px; 
      background: #f8fdff; 
      border-radius: 25px; 
      color: #2b5876; 
      font-style: italic; 
      display: none;        /* ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ ‡∏à‡∏∞‡πÇ‡∏ä‡∏ß‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠ AI ‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö */
      border-left: 10px solid #00d2ff; 
      text-align: middle;
      line-height: 1.6;      /* ‡∏£‡∏∞‡∏¢‡∏∞‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö 4 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î */
      box-sizing: border-box; 
      width: 100%;           
      word-wrap: break-word; 
      white-space: pre-line; /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ Browser ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà AI ‡∏™‡πà‡∏á‡∏°‡∏≤ */ 
      overflow-y: auto;      /* ‡∏ñ‡πâ‡∏≤‡πÄ‡∏Å‡∏¥‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏î‡πâ */
      font-size: 16px;       
      min-height: 160px;     /* ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏î‡∏µ‡∏Å‡∏±‡∏ö 4 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î */
      box-shadow: 0 10px 25px rgba(0,210,255,0.08);
    }

    .privacy-box { margin-top: 30px; font-size: 11px; color: #666; opacity: 0.9; line-height: 1.7; border-top: 1px solid #eee; padding-top: 20px; }
    .privacy-link { color: #4e4376; text-decoration: underline; cursor: pointer; font-weight: 600; }

    /* CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Custom Modal */
    .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); backdrop-filter: blur(5px); z-index: 1000; justify-content: center; align-items: center; }
    .modal-content { background: white; padding: 30px; border-radius: 30px; width: 90%; max-width: 380px; text-align: left; box-shadow: 0 20px 50px rgba(0,0,0,0.3); animation: slideUp 0.3s ease; }
    @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    .modal-header { font-weight: 600; font-size: 18px; color: #2b5876; margin-bottom: 15px; display: flex; align-items: center; gap: 10px; }
    .modal-body { font-size: 14px; color: #444; line-height: 1.6; margin-bottom: 20px; }
    .modal-close { background: #4e4376; color: white; border: none; padding: 10px 20px; border-radius: 12px; width: 100%; cursor: pointer; font-weight: 600; }
  </style>
</head>
<body>

  <div class="container">
    <div class="lang-switch">
      <button id="btnTH" class="lang-btn active" onclick="setLang('TH')">TH</button>
      <button id="btnEN" class="lang-btn" onclick="setLang('EN')">EN</button>
    </div>
  
    <h2 id="ui-title">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô '‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï' ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô '‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞‡πÄ‡∏û‡∏•‡∏á'</h2>
    <p id="ui-subtext">‡∏à‡∏≤‡∏Å ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°, ‡πÄ‡∏™‡∏µ‡∏¢‡∏á, ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ... 'MindBeat' ‡∏à‡∏∞‡πÄ‡∏ô‡∏£‡∏°‡∏¥‡∏ï‡∏ó‡πà‡∏≠‡∏ô‡∏Æ‡∏∏‡∏Å <br>‡πÉ‡∏ô‡∏™‡πÑ‡∏ï‡∏•‡πå '‡πÇ‡∏°‡πÄ‡∏î‡∏¥‡∏£‡πå‡∏ô‡∏õ‡πä‡∏≠‡∏ö' ‡∏à‡∏≤‡∏Å‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>  
    <textarea id="userInput" placeholder="‡πÄ‡∏•‡πà‡∏≤‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏ü‡∏±‡∏á‡∏´‡∏ô‡πà‡∏≠‡∏¢..."></textarea>
    <p id="ui-note" style="font-size: 11px; color: #00838f; margin: 8px 0; font-style: italic; opacity: 0.8;">*‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∏‡∏¢‡∏°‡∏≤‡∏ô‡∏∞</p>    

    <div class="btn-group">
      <button class="icon-btn" onclick="toggleRecording()" id="micBtn"><i class="fas fa-microphone"></i></button>
      <button class="icon-btn" onclick="document.getElementById('fileInput').click()"><i class="fas fa-image"></i></button>
      <input type="file" id="fileInput" style="display:none" accept="image/*" onchange="previewImage(this)">
    </div>

    <img id="preview">
    <button onclick="sendToAI()" id="sendBtn">‡∏ü‡∏±‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏Ñ‡∏∏‡∏ì üé∂</button>
    <div id="result"></div>
    <button id="saveBtn" onclick="saveToMemory()"><i class="fas fa-cloud-upload-alt"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥</button>

    <div class="privacy-box">
      <i class="fas fa-shield-alt" style="margin-right: 5px;"></i> <span id="ui-p1">‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡πà‡∏≠‡∏ô‡∏Æ‡∏∏‡∏Å‡∏•‡∏á‡πÉ‡∏ô‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</span><br>
      <a class="privacy-link" onclick="openModal()">About MindBeat & Privacy</a>
    </div>
  </div>

  <div id="infoModal" class="modal-overlay" onclick="closeModal(event)">
    <div class="modal-content" onclick="event.stopPropagation()">
      <div id="modal-about-header" class="modal-header"></div>
      <div id="modal-about-body" class="modal-body"></div>
      <div id="modal-privacy-header" class="modal-header" style="border-top: 1px solid #eee; padding-top: 15px; margin-top: 15px;"></div>
      <div id="modal-privacy-body" class="modal-body"></div>
      <button class="modal-close" onclick="closeModal()">Close</button>
    </div>
  </div>

  <script>

    let currentLang = 'TH'; let base64Image = ""; let lastHook = ""; let isRecording = false; let recognition;  
    const uiText = {
      TH: { 
        title: "‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô '‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï' ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô '‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞‡πÄ‡∏û‡∏•‡∏á'",
        subtext: "‡∏à‡∏≤‡∏Å ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°, ‡πÄ‡∏™‡∏µ‡∏¢‡∏á, ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ... 'MindBeat' ‡∏à‡∏∞‡πÄ‡∏ô‡∏£‡∏°‡∏¥‡∏ï‡∏ó‡πà‡∏≠‡∏ô‡∏Æ‡∏∏‡∏Å <br>‡πÉ‡∏ô‡∏™‡πÑ‡∏ï‡∏•‡πå '‡πÇ‡∏°‡πÄ‡∏î‡∏¥‡∏£‡πå‡∏ô‡∏õ‡πä‡∏≠‡∏ö' ‡∏à‡∏≤‡∏Å‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì",
        placeholder: "‡πÄ‡∏•‡πà‡∏≤‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏ü‡∏±‡∏á‡∏´‡∏ô‡πà‡∏≠‡∏¢...",
        send: "‡∏ü‡∏±‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏Ñ‡∏∏‡∏ì üé∂", save: "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥", loading: "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏±‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå‡∏ó‡∏≥‡∏ô‡∏≠‡∏á...",
        note: "*‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∏‡∏¢‡∏°‡∏≤‡∏ô‡∏∞",
        p1: "‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡πà‡∏≠‡∏ô‡∏Æ‡∏∏‡∏Å‡∏•‡∏á‡πÉ‡∏ô‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô",
        aboutTitle: "üéµ ‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡∏Å‡∏±‡∏ö MindBeat",
        aboutDesc: "‡πÄ‡∏£‡∏≤‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏ß‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏ó‡πÄ‡∏û‡∏•‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏π‡πâ‡πÉ‡∏à ‡πÇ‡∏î‡∏¢ MindBeat ‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô AI ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏™‡∏ô‡∏¥‡∏ó‡∏ó‡∏µ‡πà‡∏Ñ‡∏≠‡∏¢‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡πÅ‡∏•‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡∏Ñ‡∏∏‡∏ì‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏µ‡∏™‡∏ï‡∏¥ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏á‡∏î‡∏á‡∏≤‡∏°‡∏¢‡∏¥‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô",
        privacyTitle: "üõ°Ô∏è ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß",
        privacyDetail: "‚Ä¢ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô<br>‚Ä¢ ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ô‡∏ó‡∏ô‡∏≤‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏û‡∏±‡∏í‡∏ô‡∏≤ AI"
      },

      EN: { 
        title: "Turn your 'Life Beats' into 'Song Beats'",
        subtext: "From texts, voices, or photos ... <br>'MindBeat' creates 'Modern Pop' hooks from your real life.",
        placeholder: "Tell me about your day...",
        send: "Get My Hook üé∂", save: "Save to Memory", loading: "Tuning your heart...",
        note: "*I'll reply in the same language you talk to me.",
        p1: "Records are saved to your private calendar only.",
        aboutTitle: "üéµ About MindBeat",
        aboutDesc: "We transform your daily stories into meaningful songs. MindBeat is your AI best friend, listening and reflecting your reality with mindfulness.",
        privacyTitle: "üõ°Ô∏è Privacy Policy",
        privacyDetail: "‚Ä¢ Records are saved to your private calendar only.<br>‚Ä¢ Chat history is anonymized to improve our AI."
      }
    };

    function setLang(lang) {
      currentLang = lang;
      document.getElementById('btnTH').classList.toggle('active', lang === 'TH');
      document.getElementById('btnEN').classList.toggle('active', lang === 'EN');
      document.getElementById('ui-title').innerText = uiText[lang].title;
      document.getElementById('ui-subtext').innerHTML = uiText[lang].subtext;
      document.getElementById('userInput').placeholder = uiText[lang].placeholder;
      document.getElementById('sendBtn').innerText = uiText[lang].send;
      document.getElementById('saveBtn').innerHTML = `<i class="fas fa-cloud-upload-alt"></i> ${uiText[lang].save}`;
      document.getElementById('ui-note').innerText = uiText[lang].note;
      document.getElementById('ui-p1').innerText = uiText[lang].p1;
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Modal
    function openModal() {
      const t = uiText[currentLang];
      document.getElementById('modal-about-header').innerHTML = t.aboutTitle;
      document.getElementById('modal-about-body').innerHTML = t.aboutDesc;
      document.getElementById('modal-privacy-header').innerHTML = t.privacyTitle;
      document.getElementById('modal-privacy-body').innerHTML = t.privacyDetail;
      document.getElementById('infoModal').style.display = 'flex';
    }

    function closeModal() {
      document.getElementById('infoModal').style.display = 'none';
    }

    function toggleRecording() {
      if (!('webkitSpeechRecognition' in window)) return alert("Browser ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á");
      if (!isRecording) {
        recognition = new webkitSpeechRecognition(); recognition.lang = (currentLang === 'TH' ? 'th-TH' : 'en-US');
        recognition.onresult = e => document.getElementById('userInput').value += e.results[0][0].transcript;
        recognition.start(); document.getElementById('micBtn').style.background = "#ff1744"; document.getElementById('micBtn').style.color = "white";
      } else { recognition.stop(); document.getElementById('micBtn').style.background = "white"; document.getElementById('micBtn').style.color = "#00838f"; }
      isRecording = !isRecording;
    }

    function previewImage(input) {
      if (input.files && input.files[0]) {
        const reader = new FileReader();
        reader.onload = e => { document.getElementById('preview').src = e.target.result; document.getElementById('preview').style.display = "block"; base64Image = e.target.result.split(',')[1]; };
        reader.readAsDataURL(input.files[0]);
      }
    }

    function sendToAI() {
      const msg = document.getElementById('userInput').value;
      const resDiv = document.getElementById('result');
      // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ: ‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡πÑ‡∏î‡πâ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ '‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°' ‡∏´‡∏£‡∏∑‡∏≠ '‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û' ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏î‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏´‡∏ô‡∏∂‡πà‡∏á
      if (!msg.trim() && !base64Image) {
        return alert(currentLang === 'TH' ? "‡∏£‡∏ö‡∏Å‡∏ß‡∏ô‡πÄ‡∏•‡πà‡∏≤‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡∏™‡πà‡∏á‡∏£‡∏π‡∏õ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏∞" : "Please share a story or a photo first!");
      }

      resDiv.style.display = "block"; 
      resDiv.innerText = uiText[currentLang].loading;
      google.script.run.withSuccessHandler(r => { 
        resDiv.innerText = r; 
        lastHook = r; 
        document.getElementById('saveBtn').style.display = "block"; 
      }).askGemini(msg, base64Image, currentLang);
    }

    function saveToMemory() {
      const msg = document.getElementById('userInput').value;
      const btn = document.getElementById('saveBtn');
      btn.innerText = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å..."; btn.disabled = true;
      google.script.run.withSuccessHandler(res => { alert(res); btn.innerText = "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ ‚úÖ"; btn.disabled = false; }).saveToAll(msg, lastHook);
    }
  </script>
</body>
</html>
